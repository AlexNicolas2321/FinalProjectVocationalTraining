<div class="container mt-4">
  <div class="card shadow-sm rounded-4">
    <div class="card-header bg-dark text-white rounded-top-4">
      <h5 class="mb-0">Lista de Tratamientos</h5>
    </div>

    <div class="card-body p-0">
      <table *ngIf="treatments.length > 0" class="table table-striped table-bordered mb-0">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Precio</th>
            <th>ID Doctor</th>
            <th>Nombre Doctor</th>
            <th>Apellido Doctor</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let treatment of treatments">
            <td>{{ treatment.id }}</td>
            <td>{{ treatment.name }}</td>
            <td>{{ treatment.description }}</td>
            <td>{{ treatment.price | currency: 'EUR' }}</td>
            <td>{{ treatment.doctorId }}</td>
            <td>{{ treatment.doctor_first_name }}</td>
            <td>{{ treatment.doctor_last_name }}</td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="treatments.length === 0" class="alert alert-warning m-3">
        No se encontraron tratamientos.
      </div>
    </div>
  </div>
</div>

<div class="container mt-5">
  <div class="card shadow-sm rounded-4">
    <div class="card-header bg-success text-white rounded-top-4">
      <h5 class="mb-0">Crear Nuevo Tratamiento</h5>
    </div>

    <div class="card-body">
      <form (ngSubmit)="createTreatment()" #treatmentForm="ngForm" novalidate>
        
        <div class="mb-3">
          <label for="name" class="form-label">Nombre del tratamiento</label>
          <input 
            type="text" 
            id="name" 
            class="form-control" 
            name="name" 
            [(ngModel)]="newTreatment.name" 
            required />
        </div>

        <div class="mb-3">
          <label for="description" class="form-label">Descripción</label>
          <textarea 
            id="description" 
            class="form-control" 
            name="description" 
            [(ngModel)]="newTreatment.description" 
            rows="3" 
            required>
          </textarea>
        </div>

        <div class="mb-3">
          <label for="price" class="form-label">Precio (€)</label>
          <input 
            type="number" 
            id="price" 
            class="form-control" 
            name="price" 
            [(ngModel)]="newTreatment.price" 
            required 
            min="0" 
            step="0.01" />
        </div>

        <div class="mb-3">
          <label for="doctor" class="form-label">Selecciona un Doctor</label>
          <select
            class="form-select"
            id="doctor"
            [(ngModel)]="selectedDoctorId"
            name="doctor"
            required>
            <option [ngValue]="null" disabled selected>Selecciona un doctor</option>
            <option *ngFor="let doctor of doctors" [ngValue]="doctor.id">
              {{ doctor.firstName }} {{ doctor.lastName }} — {{ doctor.speciality }}
            </option>
          </select>
        </div>

        <div class="text-end">
          <button 
            type="submit" 
            class="btn btn-success"
            [disabled]="!treatmentForm.valid">
            Crear tratamiento
          </button>
        </div>

      </form>
    </div>
  </div>
</div>
