<div class="container mt-5">
  <h2 class="mb-4">Editar Roles de Usuarios</h2>

  <!-- Ver Usuarios -->
  <div class="mb-3">
    <button class="btn btn-outline-dark" type="button" data-bs-toggle="collapse" data-bs-target="#usersList">
      Ver Usuarios
    </button>
    <div class="collapse mt-3" id="usersList">
      <ul class="list-group list-group-flush">
        <li
          class="list-group-item d-flex justify-content-between align-items-center"
          *ngFor="let user of users"
        >
          <div>
            <span class="fw-bold">ID:</span> {{ user.id }},
            <span class="fw-bold">Tipo:</span> {{ user.user_type }},
            <span class="fw-bold">DNI:</span> {{ user.dni }},
            <span class="fw-bold">Nombre:</span> {{ user.first_name }},
            <span class="fw-bold">Apellido:</span> {{ user.last_name }},
            <span class="fw-bold">Roles:</span> {{ user.roleNames }}
          </div>
          <button class="btn btn-sm btn-primary" (click)="openEditRolesModal(user)">
            Editar Roles
          </button>
        </li>
      </ul>
    </div>
  </div>
</div>

<!-- Modal controlado con Angular -->
<div
  class="modal fade"
  [class.show]="isModalOpen"
  [style.display]="isModalOpen ? 'block' : 'none'"
  tabindex="-1"
  role="dialog"
  aria-modal="true"
  [attr.aria-hidden]="!isModalOpen"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Roles de Usuario</h5>
        <button
          type="button"
          class="btn-close"
          aria-label="Cerrar"
          (click)="closeModal()"
        ></button>
      </div>

      <div class="modal-body">
        <form>
          <div *ngFor="let role of allRoles" class="form-check mb-2">
            <input
              class="form-check-input"
              type="checkbox"
              [id]="role.name"
              [(ngModel)]="role.selected"
              name="role_{{ role.name }}"
            />
            <label class="form-check-label" [for]="role.name">
              {{ role.name }}
            </label>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-outline-secondary"
          (click)="closeModal()"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-success"
          (click)="submitEditRoles()"
        >
          Guardar Cambios
        </button>
      </div>
    </div>
  </div>
</div>
